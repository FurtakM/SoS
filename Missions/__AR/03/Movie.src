Export function PrepareMovie;
begin

ChangeSideFog(2, 5); // camera

CenterNowOnXY(92, 50);
Wait(0$02);
CenterOnXY(87, 65);
Wait(0$01.3);
CenterOnXY(70, 70);
Wait(0$02);
CenterOnUnits(Louis);

MovieStart = true; // Cam On!

Say(Louis, 'DL-1');

           If InVeh = true then
           begin
           Say(Martin, 'DL-2')
           end else
           begin
           Say(Martin, 'DL-2a');
           end;

ComMoveXY(ArPep, 44, 66);
ComMoveXY(Martin, 44, 64);

Wait(0$03);

AddComMoveXY(ArPep, 53, 52);
AddComMoveXY(Martin, 52, 53);
end;


// louis in base
Every 1 trigger IsInArea(Louis, Gate) do
begin
ComTurnUnit(Louis, men1);
ComTurnUnit([men1, men2, men3], Louis);
Say(Louis, 'Dl-2b');
PreparePhilip;
Wait(0$0.3);

music_nat = 4;
music_class = 5;

ComExitBuilding(Philip);
AddComTurnUnit(Philip, Louis);
Say(Philip, 'DHa');

Wait(0$0.3);

ComEnterUnit(Philip, ar_br);

ComTurnUnit([men1, men2, men3], ar_br);

music_nat = 2;
music_class = 3;

Say(men2, 'Dmen1');
Say(men1, 'Dmen2');

ComConstruct(ar_fac, 13, engine_combustion, control_manual, ar_gun);

SetSide([men1, men2, men3], 5);
ComEnterUnit([men1, men2, men3], ar_br);

Wait(0$01);



ComMoveXY(Louis, 46, 42);


                 If MyVeh then
                 begin
                 ComMoveXY(Martin, 49, 42);
                 AddComExitVehicle(Martin);
                 AddComMoveXY(Martin, 96, 51)
                 end else
                 begin
                 ComMoveXY(Martin, 96, 51)
                 end;


ComRepairVehicle(Amech1, Damaged);
End; // end part I

Every 3 trigger GetDistUnits(Louis, Amech1) < 11 do
begin
If InVeh = true then
begin
Say(Amech2, 'DM-1');
ComTurnUnit(Louis, Amech2);
Say(Amech1, 'DM-2');
ComTurnUnit(Amech2, Louis);
Say(Amech2, 'DM-3');
Wait(0$0.2);
ComTurnUnit(Amech1, Louis);
Say(Amech1, 'DM-4');
ComMoveXY(Louis, 31, 26);
Wait(0$0.3);
ComRepairVehicle([Amech1, Amech2], Damaged);
end;
ComMoveXY(Louis, 34, 30);
end; // end part II

Every 3 trigger IsInArea(Louis, GateII) do
begin
ComTurnUnit(Louis, ASol1);
Say(ASol1, 'DS-1');
Wait(0$0.3);
ComMoveXY(Louis, GetX(Abdul) + 4, GetY(Abdul) + 5);
end;

Every 3 trigger GetDistUnits(Abdul, Louis) < 10 do
begin
MovieStart = false;

SetSpecResearch(ar_lab, 100, true);


     CenterNowOnUnits(Abdul);

           AddComTurnUnit(Louis, Abdul);

                   Say(Abdul, 'DSS-1');

           ComTurnUnit(Abdul, Louis);

                   Say(Abdul, 'DDS-2');
                   Say(Louis, 'DDL-1');

           ComTurnUnit(Abdul, Farmer);

                   Say(Abdul, 'DDS-3');
                   Say(Abdul, 'DDS-4');
                   Say(Abdul, 'DDS-5');
                   Say(Abdul, 'DDS-5a');


Wait(0$0.3);

Say(Abdul, 'DDS-5b');
Say(Abdul, 'DDS-5c');

Wait(0$0.3);

Say(Abdul, 'DDS-5new1');
Say(Saliba, 'DDSalib-1');
Say(Abdul, 'DDS-5new2');
Say(Nahas, 'DDNahas-1');
Say(Abdul, 'DDS-5new3');
Say(Abdul, 'DDS-5d');

Say(Gensher, 'DDG-1');
Say(Farmer, 'DDF-1');
Say(Heike, 'DDH-1');
Say(Omar, 'DDO-1');
Say(Saliba, 'DDSalib-1');

Say(Louis, 'DDL-2');

ComTurnUnit(Abdul, Louis);

Say(Abdul, 'DDS-6');
Say(Abdul, 'DDS-6a');
Say(Louis, 'DDL-3');

           If CathyWasCatch = true then    // if Cathy live
           begin
           Say(Louis, 'DDL-CT');
           Say(Abdul, 'DDS-CT');
           end;

ComTurnUnit(Abdul, Heike);

Say(Abdul, 'DDS-7');

Wait(0$0.3);

ComEnterUnit([Heike, Omar], ar_dep2);
ComEnterUnit(Gensher, ar_dep3);
ComEnterUnit([Abdul, nahas, saliba], ar_dep1);

ComMoveXY(Farmer, GetX(Louis)-2, GetY(Louis)-1);

AddComTurnUnit(Farmer, Louis);
ComTurnUnit(Louis, Farmer);

                   Repeat
                   Wait(0$01);
                   Until GetDistUnits(Louis, Gensher) > 5;

                   Say(Farmer, 'DDF-2');
                   Say(Louis, 'DDL-5');
                   Say(Farmer, 'DDF-3');
                   Say(Louis, 'DDL-6');
                   Say(Farmer, 'DDF-4');
                   Say(Louis, 'DDL-7');

Wait(0$0.1);

ComEnterUnit(Farmer, ar_dep1);
ComHold(Louis);

Wait(0$02);

If TestCharacters('Karla_02_FarmerTeam') then
begin
Karla = CreateCharacter('Karla_02_FarmerTeam');
PlaceUnitXY(Karla, 21, 1, false);
SaveCharacters(Karla, 'Karla_02');

If TestCharacters('Dwein_02_FarmerTeam') then
begin
Dwein = CreateCharacter('Dwein_02_FarmerTeam');
PlaceUnitXY(Dwein, 23, 1, false);
SaveCharacters(Dwein, 'Dwein_02');
end else
If TestCharacters('Gunther_02_FarmerTeam') then
begin
Gunther = CreateCharacter('Gunther_02_FarmerTeam');
PlaceUnitXY(Gunther, 22, 1, false);
SaveCharacters(Gunther, 'Gunther_02');
end else
begin
KarlaAlone = true;
end;
ComMoveXY(Karla, GetX(Louis), GetY(Louis) - 4);
ComMoveXY([Gunther, Dwein], GetX(Louis), GetY(Louis) - 3);

Wait(0$04);

ComTurnUnit(Louis, Karla);
ComTurnUnit([Karla, Dwein, Gunther], Louis);

Say(Karla, 'DK-1');

If KarlaAlone = false then
begin
If IsOk(Dwein) then
Say(Dwein, 'DZ-1')
else
Say(Gunther, 'DZ-1');
end;

Say(Louis, 'DL-1n');
Say(Karla, 'DK-2');
Say(Louis, 'DL-2n');
Say(Karla, 'DK-3');
Say(Louis, 'DL-3n');
Say(Karla, 'DK-4');

ComMoveXY([Karla, Dwein, Gunther], 75, 83); // go behind camera
ComHold(Louis);

Wait(0$03);

SaveCharacters(Louis, 'Louis');
ChangeMap(1, '%_cont'); // END

end else // skip dialogs if they dont be in base

SaveCharacters(Louis, 'Louis');
ChangeMap(1, '%_cont'); // END
end;

