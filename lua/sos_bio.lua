BIO_HEIKE = 1;
BIO_KAIA = 2;
BIO_GIVI = 3;
BIO_MIKE = 4;
BIO_KAMI = 5;
BIO_OLAF = 6;
BIO_KRAY = 7;
BIO_AVIR = 8;
BIO_SOPH = 9;
BIO_FARM = 10;
BIO_OMAR = 11;
BIO_IBRA = 12;
BIO_KURT = 13;
BIO_ROLF = 24;
BIO_SHUL = 15;
BIO_JENN = 16;
BIO_KARL = 17;
BIO_GENS = 18;
BIO_JOACH = 19;
BIO_GALI = 20;
BIO_SHAR = 21;
BIO_MARK = 22;
BIO_MARIA = 23;
BIO_ANDRE = 24;
BIO_ERWIN = 25;
BIO_KOL  = 26;
BIO_RONN = 27;
BIO_NIA  = 28;
BIO_JMM  = 29;
BIO_JOAN = 30;
BIO_BARN = 31;
BIO_BOBBY = 32;
BIO_CYRUS = 33;
BIO_LISA = 34;
BIO_KHAT = 35;
BIO_MICH = 36;
BIO_ANDY = 37;
BIO_FRANK = 38;
BIO_JEFF = 39;
BIO_LUCY = 40;
BIO_TIM  = 41;
BIO_DENIS = 42;
BIO_ADAM = 43;
BIO_HARR = 44;
BIO_YAMO = 45;
BIO_HOUT = 46;
BIO_SIK  = 47;
BIO_GARY = 48;
BIO_POW  = 49;
BIO_CATH = 50;
BIO_HUGH = 51;
BIO_ROTH = 52;
BIO_GORKI = 53;
BIO_GNYE = 54;
BIO_BELK = 55;
BIO_JELE = 56;
BIO_KOVA = 57;
BIO_BELK2 = 58;
BIO_PLAT = 59;
BIO_POPO = 60;
BIO_SCHO = 61;
BIO_KUZM = 62;
BIO_TIT  = 63;
BIO_PETRO = 64;
BIO_DOLG = 65;
BIO_PETRS = 66;
BIO_GLEB = 67;
BIO_KARAM = 68;
BIO_SEVI = 69;
BIO_XAVI = 70;
BIO_YASH = 71;
BIO_KOZL = 72;
BIO_GOSS = 73;
BIO_YAKOT = 74;
BIO_GLAD = 75;
BIO_BYST = 76;
BIO_TRUM = 77;
BIO_GAYD = 78;
BIO_NICH = 79;
BIO_BASIM = 80;
BIO_RICK = 81;
BIO_LEMM = 82;
BIO_MIA = 83;
BIO_KURIN =84;

ACTIVE_BIO = 0;

avatarPath = 'SGUI/Bio/avatars/';
biographics = {
    {
        loc(8001),        -- NAME
        loc(8002),        -- DESC
        'Heike Steyer',          -- ID / IMG
        2,                -- SIDE
        1,                -- CLASS
        '24.01.1983',     -- BIRTH
        loc(TID_Chechen), -- NATIONALTY
    },
    {
        loc(8003),
        loc(8004),
        'Kaia Krizman',
        2,
        1,
        '23.03.1983',
        loc(TID_Croatia),
    },
    {
        loc(8005),
        loc(8006),
        'Givi Maisuradze',
        2,
        1,
        '26.11.1960',
        loc(TID_Georgia),
    },
    {
        loc(8007),
        loc(8008),
        'Mike Turssen',
        2,
        1,
        '7.7.1969',
        loc(TID_Germany),
    },
    {
        loc(8009),
        loc(8010),
        'Kamil Wyrick',
        2,
        2,
        '21.1.1970',
        loc(TID_Britain),
    },
    {
        loc(8011),
        loc(8012),
        'Olaf Larsson',
        2,
        3,
        '15.9.1971',
        loc(TID_Norway),
    },
    {
        loc(8013),
        loc(8014),
        'Krastyo Markov',
        2,
        3,
        '28.2.1972',
        loc(TID_Bulgaria),
    },
    {
        loc(8015),
        loc(8016),
        'Giorgi Aviradze',
        2,
        4,
        '26.7.1966',
        loc(TID_Georgia),
    },
    {
        loc(8017),
        loc(8018),
        'Sophia Spyros',
        2,
        2,
        '12.5.1975',
        loc(TID_Greece),
    },
    {
        loc(8019),
        loc(8020),
        'Robert Farmer',
        2,
        1,
        '04.12.1963',
        loc(TID_Rhodesia),
    },
    {
        loc(8021),
        loc(8022),
        'Omar Ali',
        2,
        1,
        '19.8.1970',
        loc(TID_Afghanistan),
    },
    {
        loc(8023),
        loc(8024),
        'Ibrahim Hasimow',
        2,
        4,
        '6.11.1964',
        loc(TID_Azerbaijan),
    },
    {
        loc(8025),
        loc(8026),
        'Kurt Schmidt',
        2,
        1,
        '8.06.1969',
        loc(TID_Switzerland),
    },
    {
        loc(8027),
        loc(8028),
        'Rolf Bergkampf',
        2,
        1,
        '17.11.1962',
        loc(TID_Belgium),
    },
    {
        loc(8029),
        loc(8030),
        'Louis Schulz',
        2,
        1,
        '24.08.1970',
        loc(TID_Austria),
    },
    {
        loc(8031),
        loc(8032),
        'Jenna Matover',
        2,
        4,
        '01.10.1977',
        loc(TID_Ireland),
    },
    {
        loc(8033),
        loc(8034),
        'Karla Mann',
        2,
        1,
        '29.04.1981',
        loc(TID_Belgium),
    },
    {
        loc(8035),
        loc(8036),
        'Dietrich Gensher',
        2,
        1,
        '16.03.1945',
        loc(TID_Turkey),
    },
    {
        loc(8037),
        loc(8038),
        'Joachim Schweppenburg',
        2,
        1,
        '14.12.1980',
        loc(TID_Germany),
    },
    {
        loc(8039),
        loc(8040),
        'Louis Gali',
        2,
        2,
        '24.10.1967',
        loc(TID_Algeria),
    },
    {
        loc(8041),
        loc(8042),
        'Abdul Shariff',
        2,
        1,
        '28.08.1941',
        loc(TID_Arabia),
    },
    {
        loc(8043),
        loc(8044),
        'Mark Dippi',
        2,
        3,
        '19.03.1983',
        loc(TID_Sweden),
    },
    {
        loc(8045),
        loc(8046),
        'Maria Bogdanovic',
        2,
        1,
        '24.09.1973',
        loc(TID_Bosna),
    },
    {
        loc(8047),
        loc(8048),
        'Andreas Christiansen',
        2,
        2,
        '27.05.1974',
        loc(TID_RPA),
    },
    {
        loc(8049),
        loc(8050),
        'Erwin Van Der Veen',
        2,
        1,
        '29.04.1957',
        loc(TID_Holand),
    },
    {
        loc(8051),
        loc(8052),
        'Olaf Kol',
        2,
        4,
        '16.08.1967',
        loc(TID_Estonia),
    },
    {
        loc(8053),
        loc(8054),
        'Ronn Horntvedt',
        2,
        2,
        '13.05.1969',
        loc(TID_RPA),
    },
    {
        loc(8055),
        loc(8056),
        'Nia Maisuradze',
        2,
        1,
        '18.11.1978',
        loc(TID_Georgia),
    },
    {
        loc(8057),
        loc(8058),
        'John Macmillan',
        1,
        1,
        '04.02.1968',
        loc(TID_USA),
    },
    {
        loc(8059),
        loc(8060),
        'Joan Fergusson',
        1,
        4,
        '17.03.1972',
        loc(TID_USA),
    },
    {
        loc(8061),
        loc(8062),
        'Arnold Barnes',
        1,
        1,
        '14.08.1930',
        loc(TID_USA),
    },
    {
        loc(8063),
        loc(8064),
        'Bobby Brandon',
        1,
        3,
        '23.06.1948',
        loc(TID_USA),
    },
    {
        loc(8065),
        loc(8066),
        'Cyrus Parker',
        1,
        1,
        '17.08.1971',
        loc(TID_Wales),
    },
    {
        loc(8067),
        loc(8068),
        'Lisa Lawson',
        1,
        1,
        '05.05.1976',
        loc(TID_England),
    },
    {
        loc(8069),
        loc(8070),
        'Michail Bieriezow',
        3,
        2,
        '08.01.1977',
        loc(TID_USRR),
    },
    {
        loc(8071),
        loc(8072),
        'Paul Khattam',
        1,
        4,
        '30.05.1969',
        loc(TID_Iran),
    },
    {
        loc(8073),
        loc(8074),
        'Andy Cornell',
        1,
        1,
        '03.11.1969',
        loc(TID_Ethiopia),
    },
    {
        loc(8075),
        loc(8076),
        'Frank Forsyth',
        1,
        1,
        '15.07.1966',
        loc(TID_USA),
    },
    {
        loc(8077),
        loc(8078),
        'Jeff Brown',
        1,
        2,
        '19.11.1967',
        loc(TID_USA),
    },
    {
        loc(8079),
        loc(8080),
        'Lucy Donaldson',
        1,
        1,
        '10.03.1978',
        loc(TID_Scotland),
    },
    {
        loc(8081),
        loc(8082),
        'Tim Gladstone',
        1,
        4,
        '28.02.1946',
        loc(TID_Wales),
    },
    {
        loc(8083),
        loc(8084),
        'Denis Peterson',
        1,
        4,
        '14.03.1959',
        loc(TID_England),
    },
    {
        loc(8085),
        loc(8086),
        'Adam Dawkins',
        1,
        4,
        '18.05.1962',
        loc(TID_Wales),
    },
    {
        loc(8087),
        loc(8088),
        'Ron Harrison',
        1,
        1,
        '04.23.1950',
        loc(TID_USA),
    },
    {
        loc(8089),
        loc(8090),
        'Yamoko Kikuchi',
        1,
        1,
        '21.04.1973',
        loc(TID_Japan),
    },
    {
        loc(8091),
        loc(8092),
        'Peter Van Houten',
        1,
        1,
        '11.10.1963',
        loc(TID_Holand),
    },
    {
        loc(8093),
        loc(8094),
        'Jeremy Sikorski',
        1,
        1,
        '19.06.1960',
        loc(TID_Poland),
    },
    {
        loc(8095),
        loc(8096),
        'Gary Grant',
        1,
        1,
        '02.09.1959',
        loc(TID_England),
    },
    {
        loc(8097),
        loc(8098),
        'Arthur Powell',
        1,
        1,
        '29.08.1954',
        loc(TID_USA),
    },
    {
        loc(8099),
        loc(8100),
        'Cathy Simms',
        1,
        4,
        '01.02.1975',
        loc(TID_Canada),
    },
    {
        loc(8101),
        loc(8102),
        'Hugh Stevens',
        1,
        4,
        '21.09.1957',
        loc(TID_Canada),
    },
    {
        loc(8103),
        loc(8104),
        'Peter Roth',
        1,
        4,
        '09.08.1961',
        loc(TID_USA),
    },
    {
        loc(8105),
        loc(8106),
        'Jurij Gorki',
        3,
        3,
        '04.07.1980',
        loc(TID_USRR),
    },
    {
        loc(8107),
        loc(8108),
        'Siemon Gniewko',
        3,
        1,
        '03.08.1951',
        loc(TID_USSR),
    },
    {
        loc(8109),
        loc(8110),
        'Piotr Bielkow',
        3,
        1,
        '04.01.1975',
        loc(TID_USSR),
    },
    {
        loc(8111),
        loc(8112),
        'Jelena Kirilienkowa',
        3,
        1,
        '04.01.1975',
        loc(TID_USSR),
    },

    {
        loc(8113),
        loc(8114),
        'Ilija Kowaliuk',
        3,
        3,
        '16.11.1964',
        loc(TID_USSR),
    },
    {
        loc(8115),
        loc(8116),
        'Iwan Bielkow',
        3,
        1,
        'Belkov2',
        loc(TID_USSR),
    },
    {
        loc(8117),
        loc(8118),
        'Dawid Platonow',
        3,
        3,
        '02.03.1959',
        loc(TID_USSR),
    },
    {
        loc(8119),
        loc(8120),
        'Sergiej Popow',
        3,
        1,
        '06.01.1969',
        loc(TID_USSR),
    },
    {
        loc(8121),
        loc(8122),
        'Gennady Scholtze',
        3,
        4,
        '09.07.1963',
        loc(TID_USSR),
    },
    {
        loc(8123),
        loc(8124),
        'Nikolaj Kuzmow',
        3,
        1,
        '29.01.1973',
        loc(TID_USSR),
    },
    {
        loc(8125),
        loc(8126),
        'Lew Titow',
        3,
        1,
        '03.08.1970',
        loc(TID_USSR),
    },
    {
        loc(8127),
        loc(8128),
        'Nina Pietrowowa',
        3,
        1,
        '13.10.1974',
        loc(TID_USSR),
    },
    {
        loc(8129),
        loc(8130),
        'Lazar Dolgow',
        3,
        4,
        '16.05.1950',
        loc(TID_USSR),
    },
    {
        loc(8131),
        loc(8132),
        'Gedanny Petrosjan',
        3,
        4,
        '11.11.1955',
        loc(TID_USSR),
    },
    {
        loc(8133),
        loc(8134),
        'Oleg Gleb',
        3,
        1,
        '18.09.1968',
        loc(TID_USSR),
    },
    {
        loc(8135),
        loc(8136),
        'Borys Karamazow',
        3,
        2,
        '15.08.1964',
        loc(TID_USSR),
    },
    {
        loc(8137),
        loc(8138),
        'Wsjewolod Gorki',
        3,
        1,
        '12.06.1968',
        loc(TID_USSR),
    },
    {
        loc(8139),
        loc(8140),
        'Raul Xavier',
        3,
        1,
        '21.03.1969',
        loc(TID_USSR),
    },
    {
        loc(8141),
        loc(8142),
        'Nikita Jaszin',
        3,
        1,
        '26.10.1945',
        loc(TID_USSR),
    },
    {
        loc(8143),
        loc(8144),
        'Nikita Kozlow',
        3,
        4,
        '08.07.1967',
        loc(TID_USSR),
    },
    {
        loc(8145),
        loc(8146),
        'Trofim Gossudarow',
        3,
        4,
        '23.03.1940',
        loc(TID_USSR),
    },
    {
        loc(8147),
        loc(8148),
        'Stojan Jakoticz',
        3,
        1,
        '17.07.1959',
        loc(TID_USSR),
    },
    {
        loc(8149),
        loc(8150),
        'Dimitrij Gladkow',
        3,
        1,
        '25.10.1973',
        loc(TID_USSR),
    },
    {
        loc(8151),
        loc(8152),
        'Aleksander Bystrow',
        3,
        4,
        '02.09.1956',
        loc(TID_USSR),
    },
    {
        loc(8153),
        loc(8154),
        'Jack Truman',
        1,
        1,
        '10.01.1960',
        loc(TID_USA),
    },
    {
        loc(8155),
        loc(8156),
        'Timur Gajdar',
        3,
        1,
        '30.05.1969',
        loc(TID_USSR),
    },
    {
        loc(8157),
        loc(8158),
        'Nicholas Vervecken',
        2,
        1,
        '14.11.1977',
        loc(TID_Holand),
    },
    {
        loc(8159),
        loc(8160),
        'Basim Al-Masina',
        2,
        4,
        '24.02.1970',
        loc(TID_Iraq),
    },
    {
        loc(8161),
        loc(8162),
        'Rick Hoft',
        2,
        4,
        '27.05.1974',
        loc(TID_RPA),
    },
    {
        loc(8163),
        loc(8164),
        'Lemuel Titmus',
        2,
        2,
        '11.10.1969',
        loc(TID_England),
    },
    {
        loc(8165),
        loc(8166),
        'Mia Mathiassen',
        2,
        4,
        '14.07.1979',
        loc(TID_Sweden),
    },
    {
        loc(8167),
        loc(8168),
        'Iwan Kurin',
        3,
        1,
        '25.06.1954',
        loc(TID_USSR),
    },
};

function loadBioCharactersStatus()
    local bioSave;

    if (not saveExists('sos_biographic')) then
        bioSave = OW_CUSTOMSAVE_NEW();
    else
        bioSave = OW_CUSTOMSAVE_LOAD('sos_biographic');
    end;

    local biographicsStatus = {};

    for i = 1, #biographics do
        local status = (OW_CUSTOMSAVE_READ(bioSave, i) ~= nil);
        biographicsStatus = addToArray(biographicsStatus, status);
    end;
    
    OW_CUSTOMSAVE_CLOSE(bioSave);

    return biographicsStatus;
end;

function enableBioCharacter(ID)
    local bioSave;

    if (not saveExists('sos_biographic')) then
        bioSave = OW_CUSTOMSAVE_NEW();
    else
        bioSave = OW_CUSTOMSAVE_LOAD('sos_biographic');
    end;

    OW_CUSTOMSAVE_WRITE(bioSave, parseInt(ID), true);
    OW_CUSTOMSAVE_SAVE(bioSave, 'sos_biographic');
    OW_CUSTOMSAVE_CLOSE(bioSave);
end;

function hoverOnBiographic(ID)
    setTextureID(ID, 'SGUI/Bio/placeholder-active.PNG');
end;

function unHoverOnBiographic(ID)
    setTextureID(ID, 'SGUI/Bio/placeholder.PNG');
end;

function clAvatar(PLACEHOLDER, INDEX, BIO)
    local nat = {'am', 'ar', 'ru'};
    local background = getElementEX(
        {ID=PLACEHOLDER},
        anchorLTRB,
        XYWH(4, 4, 80, 100),
        true,
        {
            texture = avatarPath .. nat[BIO[INDEX][4]] .. '.png',
        }
    );

    local avatar = getElementEX(
        background,
        anchorLTRB,
        XYWH(0, 0, 80, 100),
        true,
        {
            texture = avatarPath .. nat[BIO[INDEX][4]] .. '/' .. biographics[INDEX][3] .. '.png',
            hint = BIO[INDEX][1],
            callback_mouseleave = 'unHoverOnBiographic(' .. PLACEHOLDER .. ')',
            callback_mouseover = 'hoverOnBiographic(' .. PLACEHOLDER .. ')',
            callback_mousedown = 'openBioPopup(' .. INDEX .. ')'
        }
    );

    return avatar;
end

function clAvatarDisabled(PLACEHOLDER, INDEX, BIO)
    local nat = {'am', 'ar', 'ru'};
    local background = getElementEX(
        {ID=PLACEHOLDER},
        anchorLTRB,
        XYWH(4, 4, 80, 100),
        true,
        {
            texture = avatarPath .. nat[BIO[INDEX][4]] .. '.png',
        }
    );

    local avatar = getElementEX(
        background,
        anchorLTRB,
        XYWH(0, 0, 80, 100),
        true,
        {
            texture = avatarPath .. nat[BIO[INDEX][4]] .. '/' .. biographics[INDEX][3] .. '.png',
            hint =BIO[INDEX][1],
            callback_mousedown = 'isBioDisabledInfo();'
        }
    );

    sgui_set(background.ID, PROP_GRAYSCALE, true);
    sgui_set(avatar.ID, PROP_GRAYSCALE, true);

    return avatar;
end

function loadBiographic()
    local rowIndex = 0;
    local isActive = true;
    local status = loadBioCharactersStatus();

    for i = 1, #biographics do
        local placeholder = getElementEX(
            menu.window_bio.panel.scroll,
            anchorLTRB,
            XYWH(((i - 1) % 8) * 120 + 30, 10 + (112 * rowIndex), 88, 108),
            true,
            {
                texture = 'SGUI/Bio/placeholder.PNG'
            }
        );

        isActive = status[i];

        biographics[i][8] = isActive;
        biographics[i][9] = true;

        if isActive then
            clAvatar(placeholder.ID, i, biographics);
        else
            clAvatarDisabled(placeholder.ID, i, biographics);
        end;

        if (i % 8 == 0) then
            rowIndex = rowIndex + 1;
        end;
    end;
end;

function bioFilter(VALUE)
    VALUE = parseInt(VALUE);

    if VALUE == 0 then
        setTexture(menu.window_bio.filter_all, 'SGUI/Bio/all-active.png');
        setTexture(menu.window_bio.filter_am, 'SGUI/Bio/am-unactive.png');
        setTexture(menu.window_bio.filter_ar, 'SGUI/Bio/ar-unactive.png');
        setTexture(menu.window_bio.filter_ru, 'SGUI/Bio/ru-unactive.png');
    elseif VALUE == 1 then
        setTexture(menu.window_bio.filter_all, 'SGUI/Bio/all-unactive.png');
        setTexture(menu.window_bio.filter_am, 'SGUI/Bio/am-active.png');
        setTexture(menu.window_bio.filter_ar, 'SGUI/Bio/ar-unactive.png');
        setTexture(menu.window_bio.filter_ru, 'SGUI/Bio/ru-unactive.png');
    elseif VALUE == 2 then
        setTexture(menu.window_bio.filter_all, 'SGUI/Bio/all-unactive.png');
        setTexture(menu.window_bio.filter_am, 'SGUI/Bio/am-unactive.png');
        setTexture(menu.window_bio.filter_ar, 'SGUI/Bio/ar-active.png');
        setTexture(menu.window_bio.filter_ru, 'SGUI/Bio/ru-unactive.png');
    else
        setTexture(menu.window_bio.filter_all, 'SGUI/Bio/all-unactive.png');
        setTexture(menu.window_bio.filter_am, 'SGUI/Bio/am-unactive.png');
        setTexture(menu.window_bio.filter_ar, 'SGUI/Bio/ar-unactive.png');
        setTexture(menu.window_bio.filter_ru, 'SGUI/Bio/ru-active.png');
    end;

    deleteBiographic();

    local j = 0;
    local rowIndex = 0;
    local isActive = true;

    for i = 1, #biographics do
        local isVisible = inArray({biographics[i][4], 0}, VALUE);

        biographics[i][9] = isVisible;

        if isVisible then
            j = j + 1;

            local placeholder = getElementEX(
                menu.window_bio.panel.scroll,
                anchorLTRB,
                XYWH(((j - 1) % 8) * 120 + 30, 10 + (112 * rowIndex), 88, 108),
                true,
                {
                    texture = 'SGUI/Bio/placeholder.PNG'
                }
            );

            isActive = biographics[i][8];

            if isActive then
                clAvatar(placeholder.ID, i, biographics);
            else
                clAvatarDisabled(placeholder.ID, i, biographics);
            end;

            if (j % 8 == 0) then
                rowIndex = rowIndex + 1;
            end;
        end;
    end;
end

function deleteBiographic()
    sgui_deletechildren(menu.window_bio.panel.scroll.ID);
end;

function showBiographic(mode)
    if (mode == 1) then
        loadBiographic();
        showMenuButton(0);
        setVisible(menu.window_bio, true);
        displayDialogMessage(SOS_DIALOG_BIO_FIRST, true);

        setTexture(menu.window_bio.filter_all, 'SGUI/Bio/all-active.png');
        setTexture(menu.window_bio.filter_am, 'SGUI/Bio/am-unactive.png');
        setTexture(menu.window_bio.filter_ar, 'SGUI/Bio/ar-unactive.png');
        setTexture(menu.window_bio.filter_ru, 'SGUI/Bio/ru-unactive.png');
    else
        setVisible(menu.window_bio, false);
        deleteBiographic();
        showMenuButton(3);
    end;
end;

function openBioPopup(ID)
    ACTIVE_BIO = ID;

    local nat = {'am', 'ar', 'ru'};
    local info = loc(9200) .. ': ' .. loc(1162 + biographics[ID][5]) .. '\n' .. loc(9201) .. ': ' .. biographics[ID][6] .. '\n' .. loc(9202) .. ': ' .. biographics[ID][7];

    setVisible(menu.window_bio.popup, true);
    setText(menu.window_bio.popup.panel.name, biographics[ID][1]);
    setText(menu.window_bio.popup.panel.desc, biographics[ID][2] .. '\n\n' .. info);
    setTexture(menu.window_bio.popup.panel.avatar, avatarPath .. nat[biographics[ID][4]] .. '.png');
    setTexture(menu.window_bio.popup.panel.avatar.face, avatarPath .. nat[biographics[ID][4]] .. '/' .. biographics[ID][3] .. '.png');
    setTexture(menu.window_bio.popup.panel.avatar.nation, 'SGUI/Bio/' .. nat[biographics[ID][4]] .. '.png');

    setEnabled(menu.window_bio.popup.panel.button_prev, ID > 1);
    setEnabled(menu.window_bio.popup.panel.button_next, ID < #biographics);
end;

function showPrevBio()
    local ID = nil;

    for i = ACTIVE_BIO - 1, 1, -1 do
        if biographics[i][8] then
            ID = i;
            break;
        end;
    end;

    if ID ~= nil then
        openBioPopup(ID);
    end;
end

function showNextBio()
    local ID = nil;

    for i = ACTIVE_BIO + 1, #biographics do
        if biographics[i][8] then
            ID = i;
            break;
        end;
    end;

    if ID ~= nil then
        openBioPopup(ID);
    end;
end

function closeBioPopup()
    setVisible(menu.window_bio.popup, false);
end;

function isBioDisabledInfo()
    displayDialogMessage(SOS_DIALOG_BIO_HUMAN_DISABLED, false);
end;

menu.window_bio = getElementEX(
    menu, 
    anchorNone, 
    XYWH(0, 0, LayoutWidth, LayoutHeight), 
    false, 
    {
        colour1 = WHITEA(0)
    }
);

menu.window_bio.panel = getElementEX(
    menu.window_bio,
    anchorL, 
    XYWH(LayoutWidth / 2 - 512, LayoutHeight / 2 - 384, 1024, 768), 
    true,
    {
        texture = 'SGUI/Bio/panel.png'
    }
);

menu.window_bio.panel.scroll = getScrollboxEX(
    menu.window_bio.panel, 
    anchorLTBR,
    XYWH(0, 50, 966, 704), 
    {
        colour1 = WHITEA()
    }
);

set_Property(menu.window_bio.panel.scroll.ID, PROP_AUTOHIDESCROLL, false);

menu.window_bio.panel.scroll.scrollV = clScrollBarEX2(
    menu.window_bio.panel, 
    anchorTRB,
    XYWH(
        menu.window_bio.panel.scroll.x + menu.window_bio.panel.scroll.width + 6,
        menu.window_bio.panel.scroll.y, 
        12, 
        menu.window_bio.panel.scroll.height
    ),
    menu.window_bio.panel.scroll, 
    SKINTYPE_NONE,
    false,
    {}
);

menu.window_bio.border = getElementEX(
    menu.window_bio,
    anchorLTRB,
    XYWH(0, 48, 966, 2),
    true,
    {
        colour1 = BLACK(100),
    }
);

menu.window_bio.panel.button_quit = clButton(
    menu.window_bio, 
    14, 
    10, 
    230, 
    18, 
    loc(TID_Main_Menu_Campaign_Back), 
    'showBiographic(0);', 
    {}
);

menu.window_bio.filter_all = getImageButtonEX(
    menu.window_bio,
    anchorLTRB,
    XYWH(748, 2, 44, 44),
    '',
    '',
    'bioFilter(0)',
    SKINTYPE_NONE,
    {
        texture = 'SGUI/Bio/all-active.png'
    }
);

menu.window_bio.filter_am = getImageButtonEX(
    menu.window_bio,
    anchorLTRB,
    XYWH(800, 2, 44, 44),
    '',
    '',
    'bioFilter(1)',
    SKINTYPE_NONE,
    {
        texture = 'SGUI/Bio/am-active.png'
    }
);

menu.window_bio.filter_ar = getImageButtonEX(
    menu.window_bio,
    anchorLTRB,
    XYWH(852, 2, 44, 44),
    '',
    '',
    'bioFilter(2)',
    SKINTYPE_NONE,
    {
        texture = 'SGUI/Bio/ar-active.png'
    }
);

menu.window_bio.filter_ru = getImageButtonEX(
    menu.window_bio,
    anchorLTRB,
    XYWH(904, 2, 44, 44),
    '',
    '',
    'bioFilter(3)',
    SKINTYPE_NONE,
    {
        texture = 'SGUI/Bio/ru-active.png'
    }
);

menu.window_bio.popup = getElementEX(
    nil,
    anchorLTRB,
    XYWH(0, 0, LayoutWidth, LayoutHeight),
    false,
    {
        colour1 = BLACKA(50)
    }
);

menu.window_bio.popup.panel = getElementEX(
    menu.window_bio.popup,
    anchorNone,
    XYWH(menu.window_bio.popup.width / 2 - 400, menu.window_bio.popup.height / 2 - 300, 800, 600),
    true,
    {
        texture = 'SGUI/Bio/popup.png'
    }
);

menu.window_bio.popup.panel.avatar = getElementEX(
    menu.window_bio.popup.panel,
    anchorNone,
    XYWH(54, 28, 320, 400),
    true,
    {}
);

menu.window_bio.popup.panel.avatar.face = getElementEX(
    menu.window_bio.popup.panel.avatar,
    anchorNone,
    XYWH(0, 0, 320, 400),
    true,
    {}
);

menu.window_bio.popup.panel.avatar.nation = getElementEX(
    menu.window_bio.popup.panel.avatar.face,
    anchorNone,
    XYWH(265, 350, 51, 48),
    true,
    {
        texture = 'SGUI/Bio/ar.png'
    }
);

menu.window_bio.popup.panel.desc = getLabelEX(
    menu.window_bio.popup.panel, 
    anchorLT, 
    XYWH(426, 40, 330, 300), 
    ADMUI3L, 
    '',
    {
        wordwrap = true,
        text_halign = ALIGN_LEFT,
        text_valign = ALIGN_TOP,
        font_colour = BLACK(255)
    }
);

menu.window_bio.popup.panel.name = getLabelEX(
    menu.window_bio.popup.panel, 
    anchorT, 
    XYWH(65, 434, 300, 40),
    Tahoma_30B, 
    '',
    {
        wordwrap = true,
        text_halign = ALIGN_MIDDLE,
        text_valign = ALIGN_TOP,
        font_colour = RGB(231, 222, 214),
        shadowtext = true,
        text_case = CASE_UPPER
    }
);

menu.window_bio.popup.panel.button_quit = clButton(
    menu.window_bio.popup.panel, 
    285, 
    560, 
    230, 
    18, 
    loc(1135), 
    'closeBioPopup();', 
    {}
);

menu.window_bio.popup.panel.button_prev = clButton(
    menu.window_bio.popup.panel, 
    40, 
    560, 
    230, 
    18, 
    '<<', 
    'showPrevBio();', 
    {}
);

menu.window_bio.popup.panel.button_next = clButton(
    menu.window_bio.popup.panel, 
    530, 
    560, 
    230, 
    18, 
    '>>', 
    'showNextBio();', 
    {}
);